# Chewatabingo - Bingo Game

## Overview
A real-time multiplayer Bingo game built with Node.js, Express, and WebSockets. Players can register, login, manage their wallet, select bingo cards, participate in live games, and compete to win. The application includes Telegram Web App integration for enhanced user experience.

## Project Architecture
- **Backend**: Node.js + Express server with WebSocket support for real-time communication
- **Frontend**: Vanilla JavaScript with HTML/CSS (in `public/` folder)
- **Database**: PostgreSQL for persistent data storage
- **Real-time**: WebSocket-based game state synchronization
- **Auth**: JWT-based authentication with Telegram integration
- **Deployment**: Configured for Render.com deployment

## Tech Stack
- Node.js with Express v5.2.1
- WebSocket (ws) v8.18.3
- PostgreSQL (pg) v8.13.1
- JWT authentication (jsonwebtoken)
- bcryptjs for password hashing
- Vanilla JavaScript (no frameworks)
- Telegram Web App API integration

## File Structure
```
├── server.js           # Express server with WebSocket game logic
├── package.json        # Dependencies and scripts
├── render.yaml         # Render deployment configuration
├── .env.example        # Example environment variables
├── db/
│   ├── database.js     # Database connection and initialization
│   └── schema.sql      # Full database schema
├── models/
│   ├── User.js         # User model with auth methods
│   ├── Wallet.js       # Wallet operations (deposit, withdraw, stake, win)
│   └── Game.js         # Game and participant tracking
└── public/
    ├── index.html      # Main HTML file with auth UI
    ├── game.js         # Client-side game logic
    ├── card.js         # Bingo card data (99 pre-generated cards)
    └── style.css       # Styling
```

## Database Schema
- **users**: Player accounts (id, username, telegram_id, password_hash)
- **wallets**: Player balances (user_id, balance, currency)
- **transactions**: Wallet history (type: deposit/withdrawal/stake/win)
- **games**: Game sessions (stake_amount, status, winner, called_numbers)
- **game_participants**: Players in each game (user_id, card_id, is_winner)

## Game Flow
1. **Landing Screen**: Players select stake amount and start game
2. **Authentication**: Login/Register (or auto-auth via Telegram)
3. **Selection Phase**: Players choose from 99 available bingo cards (45s timer)
4. **Game Phase**: Numbers are called every 3 seconds, players mark their cards
5. **Winner Phase**: First player to complete a valid bingo pattern wins (5s display)
6. Loop back to selection phase

## Render Deployment
1. Connect your GitHub repository to Render
2. Select "Web Service"
3. Render will auto-detect settings from `render.yaml`
4. Render will also create a PostgreSQL database automatically
5. Deploy!

Or manually configure:
- **Build Command**: `npm install`
- **Start Command**: `npm start`
- **Environment**: Node
- **Database**: Create PostgreSQL instance

## Environment Variables
- `PORT` - Set automatically by Render (default: 10000 for local development)
- `DATABASE_URL` - PostgreSQL connection string (auto-set by Render)
- `JWT_SECRET` - Secret key for JWT tokens (auto-generated by Render)
- `NODE_ENV` - Set to "production" on Render

## Recent Changes
- Added PostgreSQL database support
- Implemented user registration and login
- Added wallet system with balance tracking
- Added transaction history
- Added game history and player stats
- Updated frontend with auth UI and balance display
- Configured for Render.com deployment with database
